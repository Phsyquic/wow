<main class="bises-page">
  <section class="top-panel">
    <div class="panel-title">
      <h1>BiS Atlas</h1>
      <p>Explore best-in-slot sources by instance, boss, specialization and slot.</p>
    </div>

    <div class="filters-grid">
      <select name="Instances" id="instances" (change)="filtrar(0, $event)">
        <option value="">Location</option>
        <option [value]="instance" *ngFor="let instance of instancesLibrary">{{instance}}</option>
      </select>

      <select *ngIf="encounterFlag != -1" name="Bosses" id="bosses" (change)="filtrar(1, $event)">
        <option *ngIf="encounterFlag == 0" value="">Bosses</option>
        <option *ngIf="encounterFlag == 1" value="">Dungeons</option>
        <option [value]="boss" *ngFor="let boss of encounterLibrary[encounterFlag]">{{boss}}</option>
      </select>

      <select name="Specs" id="specs" (change)="filtrar(2, $event)">
        <option value="">Specs</option>
        <option [value]="spec" *ngFor="let spec of specsLibrary">{{spec}}</option>
      </select>

      <select name="Slots" id="slots" (change)="filtrar(3, $event)">
        <option value="">Slots</option>
        <option [value]="i" *ngFor="let slot of slotsLibrary; let i = index">{{capitalizeFirstLetter(slot)}}</option>
      </select>
    </div>

    <div class="actions-row">
      <button class="btn ghost" title="Recargar BiS desde Wowhead" (click)="reloadBisFromWowhead()">â†»</button>
      <button class="btn ghost" title="Cachear items faltantes en Blizzard API" (click)="cacheMissingItems()">ðŸ—„</button>
      <button class="btn ghost danger" title="Limpiar cache de items" (click)="clearItemCache()">ðŸ—‘</button>
      <button class="btn ghost" *ngIf="tableBisList != tableBisList_full" (click)="resetFiltros()">Reset</button>
      <button class="btn primary" (click)="goMain()">Main</button>
    </div>
  </section>

  <section class="items-grid" *ngIf="!isLoading">
    <article *ngFor="let item of tableBisList" class="bis-card">
      <img *ngIf="item.img" [src]="item.img" alt="Item Image">
      <div class="item-content">
        <h3>{{capitalizeFirstLetter(item.name)}}</h3>
        <p>{{ item.boss ? item.boss : item.instance }}</p>
        <div class="spec-tags">
          <span *ngFor="let spec of item.spec" [ngStyle]="{'color': generateColor(spec)}">{{spec}}</span>
        </div>
      </div>
    </article>
  </section>

  <div *ngIf="isLoading" class="loading-message">
    <p>Procesando...</p>
  </div>
</main>
