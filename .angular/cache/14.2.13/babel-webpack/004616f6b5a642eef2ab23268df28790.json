{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/ivan_romero/Proyecto_personal/wow/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpClient } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let DiscordApiService = /*#__PURE__*/(() => {\n  class DiscordApiService {\n    constructor(http) {\n      this.http = http; // Las credenciales deben ser manejadas de forma segura\n\n      this.access_token = '';\n      this.refresh_token = '';\n      this.token_type = '';\n    } // Método para obtener mensajes del canal\n\n\n    getMensajes(channelId) {\n      const _url = `https://discord.com/api/channels/${channelId}/messages`; // Asegúrate de que el token se haya obtenido correctamente\n\n      if (!this.access_token) {\n        throw new Error('Access token is missing. Call getAuthorize() first.');\n      }\n\n      return this.http.get(_url, {\n        headers: {\n          'Authorization': `${this.token_type} ${this.access_token}`\n        }\n      });\n    } // Método para obtener el token de autorización\n\n\n    getAuthorize(code) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        const _url = 'https://discord.com/api/oauth2/token';\n        const clientId = '1090348260201332746';\n        const clientSecret = 'vn7bkNNwCvHO9UkegZllg748yyEJwi_Z';\n        const params = new URLSearchParams();\n        params.append('client_id', clientId);\n        params.append('client_secret', clientSecret);\n        params.append('grant_type', 'authorization_code');\n        params.append('code', code);\n        params.append('redirect_uri', 'http://localhost:4200/'); // Asegúrate de que esto coincida con tu configuración de Discord\n\n        params.append('scope', 'identify');\n\n        try {\n          const response = yield fetch(_url, {\n            method: 'POST',\n            body: params,\n            headers: {\n              \"Content-Type\": \"application/x-www-form-urlencoded\"\n            }\n          }); // Verifica si la respuesta fue exitosa\n\n          if (!response.ok) {\n            throw new Error(`Error: ${response.statusText}`);\n          }\n\n          const json = yield response.json();\n          _this.access_token = json.access_token;\n          _this.refresh_token = json.refresh_token;\n          _this.token_type = json.token_type;\n        } catch (error) {\n          console.error('Error during authorization:', error);\n          throw error; // Puedes lanzar el error o manejarlo de otra manera\n        }\n      })();\n    }\n\n  }\n\n  DiscordApiService.ɵfac = function DiscordApiService_Factory(t) {\n    return new (t || DiscordApiService)(i0.ɵɵinject(i1.HttpClient));\n  };\n\n  DiscordApiService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: DiscordApiService,\n    factory: DiscordApiService.ɵfac,\n    providedIn: 'root'\n  });\n  return DiscordApiService;\n})();","map":null,"metadata":{},"sourceType":"module"}