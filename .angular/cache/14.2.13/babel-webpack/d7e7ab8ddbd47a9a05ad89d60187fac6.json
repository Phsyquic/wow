{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/ivan_romero/Proyecto_personal/wow/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { forkJoin } from 'rxjs';\nimport { firstValueFrom } from 'rxjs';\nimport { scrapeWowheadPage } from '../utils/wowhead-scraper';\nimport { extractWowheadBisList } from '../utils/wowhead-bis-parser';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../services/local-data.service\";\nimport * as i3 from \"../services/raidbots-api.service\";\nimport * as i4 from \"../services/blizzard-api.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\n\nfunction BisesComponent_option_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const instance_r11 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", instance_r11);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(instance_r11);\n  }\n}\n\nfunction BisesComponent_select_12_option_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 5);\n    i0.ɵɵtext(1, \"Bosses\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction BisesComponent_select_12_option_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 5);\n    i0.ɵɵtext(1, \"Dungeons\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction BisesComponent_select_12_option_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const boss_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", boss_r15);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(boss_r15);\n  }\n}\n\nfunction BisesComponent_select_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"select\", 19);\n    i0.ɵɵlistener(\"change\", function BisesComponent_select_12_Template_select_change_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.filtrar(1, $event));\n    });\n    i0.ɵɵtemplate(1, BisesComponent_select_12_option_1_Template, 2, 0, \"option\", 20);\n    i0.ɵɵtemplate(2, BisesComponent_select_12_option_2_Template, 2, 0, \"option\", 20);\n    i0.ɵɵtemplate(3, BisesComponent_select_12_option_3_Template, 2, 2, \"option\", 6);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.encounterFlag == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.encounterFlag == 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.encounterLibrary[ctx_r1.encounterFlag]);\n  }\n}\n\nfunction BisesComponent_option_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const spec_r18 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", spec_r18);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(spec_r18);\n  }\n}\n\nfunction BisesComponent_option_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const slot_r19 = ctx.$implicit;\n    const i_r20 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", i_r20);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.formatSlotLabel(slot_r19));\n  }\n}\n\nfunction BisesComponent_ng_container_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function BisesComponent_ng_container_22_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.reloadBisFromWowhead());\n    });\n    i0.ɵɵtext(2, \"\\u21BB\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function BisesComponent_ng_container_22_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.cacheMissingItems());\n    });\n    i0.ɵɵtext(4, \"\\uD83D\\uDDC4\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function BisesComponent_ng_container_22_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.clearItemCache());\n    });\n    i0.ɵɵtext(6, \"\\uD83D\\uDDD1\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction BisesComponent_ng_template_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function BisesComponent_ng_template_23_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.openAdminModal());\n    });\n    i0.ɵɵtext(1, \"\\u2699\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction BisesComponent_button_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function BisesComponent_button_25_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.resetFiltros());\n    });\n    i0.ɵɵtext(1, \"Reset\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction BisesComponent_section_28_article_1_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 33);\n  }\n\n  if (rf & 2) {\n    const item_r30 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", item_r30.img, i0.ɵɵsanitizeUrl);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"color\": a0\n  };\n};\n\nfunction BisesComponent_section_28_article_1_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const spec_r34 = ctx.$implicit;\n    const ctx_r32 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(2, _c0, ctx_r32.generateColor(spec_r34)));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(spec_r34);\n  }\n}\n\nfunction BisesComponent_section_28_article_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"article\", 28);\n    i0.ɵɵtemplate(1, BisesComponent_section_28_article_1_img_1_Template, 1, 1, \"img\", 29);\n    i0.ɵɵelementStart(2, \"div\", 30)(3, \"h3\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 31);\n    i0.ɵɵtemplate(8, BisesComponent_section_28_article_1_span_8_Template, 2, 4, \"span\", 32);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const item_r30 = ctx.$implicit;\n    const ctx_r29 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r30.img);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r29.capitalizeFirstLetter(item_r30.name));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r30.boss ? item_r30.boss : item_r30.instance);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", item_r30.spec);\n  }\n}\n\nfunction BisesComponent_section_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\", 26);\n    i0.ɵɵtemplate(1, BisesComponent_section_28_article_1_Template, 9, 4, \"article\", 27);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r8.tableBisList);\n  }\n}\n\nfunction BisesComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35)(1, \"p\");\n    i0.ɵɵtext(2, \"Procesando...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction BisesComponent_div_30_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 41);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r35 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r35.adminPasswordError);\n  }\n}\n\nfunction BisesComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r37 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 36);\n    i0.ɵɵlistener(\"click\", function BisesComponent_div_30_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r36 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r36.closeAdminModal());\n    });\n    i0.ɵɵelementStart(1, \"section\", 37);\n    i0.ɵɵlistener(\"click\", function BisesComponent_div_30_Template_section_click_1_listener($event) {\n      return $event.stopPropagation();\n    });\n    i0.ɵɵelementStart(2, \"h3\");\n    i0.ɵɵtext(3, \"Acceso Admin\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5, \"Introduce password para activar configuraci\\u00F3n.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"input\", 38);\n    i0.ɵɵlistener(\"ngModelChange\", function BisesComponent_div_30_Template_input_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r39 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r39.adminPasswordInput = $event);\n    })(\"keydown.enter\", function BisesComponent_div_30_Template_input_keydown_enter_6_listener() {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r40 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r40.submitAdminPassword());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, BisesComponent_div_30_p_7_Template, 2, 1, \"p\", 39);\n    i0.ɵɵelementStart(8, \"div\", 40)(9, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function BisesComponent_div_30_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r41 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r41.closeAdminModal());\n    });\n    i0.ɵɵtext(10, \"Cancelar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function BisesComponent_div_30_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r37);\n      const ctx_r42 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r42.submitAdminPassword());\n    });\n    i0.ɵɵtext(12, \"Entrar\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", ctx_r10.adminPasswordInput);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r10.adminPasswordError);\n  }\n}\n\nexport let BisesComponent = /*#__PURE__*/(() => {\n  class BisesComponent {\n    constructor(http, LocalDataService, RaidbotsApiService, blizzardService, router) {\n      this.http = http;\n      this.LocalDataService = LocalDataService;\n      this.RaidbotsApiService = RaidbotsApiService;\n      this.blizzardService = blizzardService;\n      this.router = router;\n      this.PH_image2 = 'https://wow.zamimg.com/images/wow/icons/large/inv_10_jewelcrafting_gem3primal_fire_cut_blue.jpg';\n      this.PH_image0 = 'https://wow.zamimg.com/images/wow/icons/large/inv_10_jewelcrafting_gem3primal_fire_cut_bronze.jpg';\n      this.PH_image3 = 'https://wow.zamimg.com/images/wow/icons/large/inv_10_jewelcrafting_gem3primal_fire_cut_green.jpg';\n      this.PH_image1 = 'https://wow.zamimg.com/images/wow/icons/large/inv_10_jewelcrafting_gem3primal_fire_cut_red.jpg';\n      this.allBisList = [];\n      this.tableBisList = [];\n      this.tableBisList_full = [];\n      this.instances = [];\n      this.itemList = [];\n      this.itemList_full = [];\n      this.instancesLibrary = [];\n      this.encounterLibrary = [];\n      this.specsLibrary = [];\n      this.slotsLibrary = [];\n      this.encounterFlag = -1;\n      this.isLoading = true;\n      this.selectedInstance = '';\n      this.selectedEncounter = '';\n      this.selectedSpec = '';\n      this.selectedSlot = '';\n      this.isReloadingBis = false;\n      this.isAdminConfigEnabled = false;\n      this.showAdminModal = false;\n      this.adminPasswordInput = '';\n      this.adminPasswordError = '';\n      this.wowIconBase = 'https://wow.zamimg.com/images/wow/icons/large/';\n      this.cacheApiBase = 'http://localhost:3000';\n      this.generatedBisSources = {};\n      this.encounterNameCache = {};\n      this.adminConfigStorageKey = 'config';\n      this.adminPassword = '6190';\n    }\n\n    ngOnInit() {\n      this.loadAdminConfigState();\n      this.loadInitialData();\n    }\n\n    loadInitialData() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        try {\n          _this.generatedBisSources = _this.LocalDataService.getGeneratedBisSources();\n          yield _this.getBisListData();\n          yield _this.getBosses();\n        } catch (error) {\n          console.error(\"Hubo un error al cargar la bis list:\", error);\n        } finally {\n          _this.isLoading = false;\n        }\n      })();\n    }\n\n    getBisListData() {\n      return new Promise((resolve, reject) => {\n        this.LocalDataService.getBisListTxt().subscribe({\n          next: data => {\n            var array = data.split(/\\r?\\n/);\n            array = this.splitArrayByEmpty(array);\n            this.allBisList = []; // Procesamos los elementos y los agregamos a allBisList\n\n            array.forEach(element => {\n              var elementArray = [this.limpiarSpec(element[0])];\n              element.forEach(item => {\n                if (typeof item === 'number' || !isNaN(Number(item))) {\n                  elementArray.push(item);\n                }\n              });\n              this.allBisList.push(elementArray);\n            }); // Limpiamos la tabla antes de generar los nuevos ítems\n\n            this.tableBisList = []; // Ahora, usamos Promise.all para esperar a que todas las llamadas a generateTable terminen\n\n            Promise.all(this.allBisList.map(classBis => this.generateTable(classBis))).then(() => {\n              console.log('Todos los ítems han sido procesados');\n              resolve(); // Resolvemos la promesa cuando todos los ítems hayan sido agregados\n            }).catch(err => {\n              console.error('Error al generar la tabla:', err);\n              reject(err); // Rechazamos la promesa en caso de error\n            });\n          },\n          error: err => {\n            console.error('Error al obtener el archivo BisList:', err);\n            reject(err); // Rechazamos la promesa si hay un error en la suscripción\n          }\n        });\n      });\n    }\n\n    splitArrayByEmpty(arr) {\n      const result = []; // Array que contendrá los grupos\n\n      let currentGroup = []; // Grupo actual que estamos construyendo\n\n      for (const item of arr) {\n        if (item === '') {\n          // Si encontramos un elemento vacío, añadimos el grupo actual al resultado\n          if (currentGroup.length > 0) {\n            result.push(currentGroup);\n            currentGroup = []; // Reiniciar el grupo actual\n          }\n        } else {\n          // Si no es un elemento vacío, lo añadimos al grupo actual\n          currentGroup.push(item);\n        }\n      } // Añadir el último grupo si existe\n\n\n      if (currentGroup.length > 0) {\n        result.push(currentGroup);\n      }\n\n      return result;\n    }\n\n    limpiarSpec(str) {\n      const words = str.split(\" \"); // Divide la cadena en palabras\n\n      const lastWord = words.pop(); // Extrae la última palabra\n\n      if (lastWord) {\n        words.unshift(lastWord); // Coloca la última palabra al principio\n      } // Si hay más de 2 palabras, cambiar los espacios a guiones entre las palabras restantes\n\n\n      if (words.length > 1) {\n        return [words[0], words.slice(1).join(\"-\")].join(\" \"); // Únelo con guiones y coloca la última palabra al principio\n      }\n\n      return words.join(\" \"); // Si es solo una palabra, devuélvela tal cual\n    }\n\n    capitalizeFirstLetter(string) {\n      return string.charAt(0).toUpperCase() + string.slice(1);\n    }\n\n    formatSlotLabel(slot) {\n      if (slot === 'main_hand') {\n        return 'Weapon';\n      }\n\n      if (slot === 'off_hand') {\n        return 'Offhand';\n      }\n\n      return this.capitalizeFirstLetter(slot);\n    }\n\n    generateTable(bisList) {\n      return new Promise((resolve, reject) => {\n        var spec = bisList[0];\n        bisList.slice(1).forEach(element => {\n          var item = {\n            id: element,\n            spec: [spec],\n            img: null,\n            name: `Item ${element}`\n          }; // Comprobar si ya existe un ítem con el mismo id en tableBisList\n\n          const existingItem = this.tableBisList.find(existingItem => existingItem.id === item.id);\n\n          if (!existingItem) {\n            this.tableBisList.push(item);\n          } else {\n            existingItem.spec.push(spec);\n          }\n        });\n        resolve();\n      });\n    }\n\n    loadAdminConfigState() {\n      this.isAdminConfigEnabled = localStorage.getItem(this.adminConfigStorageKey) === 'true';\n    }\n\n    openAdminModal() {\n      this.adminPasswordInput = '';\n      this.adminPasswordError = '';\n      this.showAdminModal = true;\n    }\n\n    closeAdminModal() {\n      this.showAdminModal = false;\n      this.adminPasswordInput = '';\n      this.adminPasswordError = '';\n    }\n\n    submitAdminPassword() {\n      if (this.adminPasswordInput === this.adminPassword) {\n        localStorage.setItem(this.adminConfigStorageKey, 'true');\n        this.isAdminConfigEnabled = true;\n        this.closeAdminModal();\n        return;\n      }\n\n      this.adminPasswordError = 'Password incorrecta';\n    }\n\n    getImgLink(id) {\n      return new Promise((resolve, reject) => {\n        this.blizzardService.getItemMedia(id).subscribe(response => {\n          var imageUrl = response.assets.find(asset => asset.key === 'icon')?.value || null;\n          resolve(imageUrl);\n        }, error => {\n          console.error('Error fetching item media', error);\n          reject(error);\n        });\n      });\n    }\n\n    getItemName(id) {\n      return new Promise((resolve, reject) => {\n        this.blizzardService.getItemName(id).subscribe(data => {\n          resolve(data.name);\n        }, error => {\n          console.error('Error fetching item name', error);\n          reject(error);\n        });\n      });\n    }\n\n    sumarArrays(arrays) {\n      // Usamos reduce para combinar todos los arrays en uno solo\n      return arrays.reduce((resultado, array) => {\n        // Excluimos el primer elemento de cada array usando slice(1)\n        const arraySinPrimerElemento = array.slice(1); // Sumamos los elementos restantes del array al resultado\n\n        return resultado.concat(arraySinPrimerElemento);\n      }, []);\n    }\n\n    generateColor(spec) {\n      if (spec == 'Devastation Evoker' || spec == 'Augmentation Evoker' || spec == 'Preservation Evoker') {\n        return '#33937f';\n      }\n\n      if (spec == 'Balance Druid' || spec == 'Feral Druid' || spec == 'Guardian Druid' || spec == 'Restoration Druid') {\n        return '#ff7d0a';\n      }\n\n      if (spec == 'Unholy Death-Knight' || spec == 'Frost Death-Knight' || spec == 'Blood Death-Knight') {\n        return '#c41f3b';\n      }\n\n      if (spec == 'Havoc Demon-Hunter' || spec == 'Vengeance Demon-Hunter') {\n        return '#a330c9';\n      }\n\n      if (spec == 'Beast-Mastery Hunter' || spec == 'Marksmanship Hunter' || spec == 'Survival Hunter') {\n        return '#abd473';\n      }\n\n      if (spec == 'Enhancement Shaman' || spec == 'Elemental Shaman' || spec == 'Restoration Shaman') {\n        return '#0070de';\n      }\n\n      if (spec == 'Assassination Rogue' || spec == 'Outlaw Rogue' || spec == 'Subtlety Rogue') {\n        return '#e6d600';\n      }\n\n      if (spec == 'Arcane Mage' || spec == 'Frost Mage' || spec == 'Fire Mage') {\n        return '#69ccf0';\n      }\n\n      if (spec == 'Windwalker Monk' || spec == 'Brewmaster Monk' || spec == 'Mistweaver Monk') {\n        return '#00ff96';\n      }\n\n      if (spec == 'Fury Warrior' || spec == 'Arms Warrior' || spec == 'Protection Warrior') {\n        return '#c79c6e';\n      }\n\n      if (spec == 'Affliction Warlock' || spec == 'Demonology Warlock' || spec == 'Destruction Warlock') {\n        return '#9482c9';\n      }\n\n      if (spec == 'Shadow Priest' || spec == 'Holy Priest' || spec == 'Discipline Priest') {\n        return '#c6c1b9';\n      }\n\n      if (spec == 'Retribution Paladin' || spec == 'Protection Paladin' || spec == 'Holy Paladin') {\n        return '#f58cba';\n      }\n\n      return 'black';\n    }\n\n    getBosses() {\n      var _this2 = this;\n\n      return new Promise((resolve, reject) => {\n        forkJoin([this.RaidbotsApiService.getInstances(), this.RaidbotsApiService.getItemList()]).subscribe({\n          next: function () {\n            var _ref = _asyncToGenerator(function* ([instancesData, itemListData]) {\n              // Aseguramos que los datos sean arrays\n              if (Array.isArray(instancesData)) {\n                instancesData.forEach(element => {\n                  var instance = {\n                    id: element.id,\n                    name: element.name,\n                    type: element.type\n                  };\n\n                  _this2.instances.push(instance);\n                });\n              } else {\n                console.error('La respuesta de las instancias no es un array', instancesData);\n              } // Procesamos la lista de ítems solo si itemListData es un array\n\n\n              if (Array.isArray(itemListData)) {\n                _this2.itemList_full = itemListData;\n                itemListData.forEach(element => {\n                  const isUniversalTierToken = element.itemClass === 15 && element.itemSubClass === 0 && Array.isArray(element.contains) && element.contains.length > 20;\n\n                  if (isUniversalTierToken) {\n                    return;\n                  }\n\n                  if (element.sources) {\n                    var item = {\n                      id: element.id,\n                      drop: element.sources[0]\n                    };\n\n                    _this2.itemList.push(item);\n                  }\n                });\n              } else {\n                console.error('La respuesta de los ítems no es un array', itemListData);\n              } // Llamamos a getItemsDrop una vez que ambas respuestas se procesen\n\n\n              yield _this2.getItemsDrop();\n              resolve();\n            });\n\n            return function next(_x) {\n              return _ref.apply(this, arguments);\n            };\n          }(),\n          error: err => {\n            console.error('Error en la llamada de forkJoin:', err);\n            reject(err);\n          }\n        });\n      });\n    }\n\n    getItemsDrop() {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        var realItemList = [];\n        const encounterIds = [...new Set(_this3.itemList.map(element => Number(element?.drop?.encounterId)).filter(id => Number.isInteger(id) && id > 0))];\n        const encounterNameMap = {};\n        yield Promise.all(encounterIds.map( /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (encounterId) {\n            if (_this3.encounterNameCache[encounterId]) {\n              encounterNameMap[encounterId] = _this3.encounterNameCache[encounterId];\n              return;\n            }\n\n            const encounterName = yield _this3.getEncounter(encounterId);\n\n            if (encounterName && encounterName !== 'N/A') {\n              _this3.encounterNameCache[encounterId] = encounterName;\n              encounterNameMap[encounterId] = encounterName;\n            }\n          });\n\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }())); // Usamos 'for...of' para poder usar 'await' dentro del ciclo\n\n        for (const element of _this3.itemList) {\n          var dropID = element.drop.instanceId;\n\n          var ins = _this3.instances.find(item => dropID === item.id);\n\n          var item = {};\n\n          if (ins) {\n            if (ins.type === 'raid') {\n              const encounterId = Number(element.drop.encounterId);\n\n              if (encounterId === -67) {\n                item = {\n                  id: element.id,\n                  instance: ins,\n                  boss: 'catalyst'\n                };\n                realItemList.push(item);\n              } else if (encounterId <= 0) {\n                item = {\n                  id: element.id,\n                  instance: ins,\n                  boss: 'BoE'\n                };\n                realItemList.push(item);\n              } else {\n                item = {\n                  id: element.id,\n                  instance: ins,\n                  boss: encounterNameMap[encounterId] || _this3.encounterNameCache[encounterId] || `Encounter ${encounterId}`\n                };\n                realItemList.push(item);\n              }\n            } else {\n              item = {\n                id: element.id,\n                instance: ins\n              };\n              realItemList.push(item);\n            }\n          } else {\n            item = {\n              id: element.id,\n              instance: ins\n            };\n            realItemList.push(item);\n          }\n        } // Una vez procesados todos los elementos, actualizamos 'this.itemList'\n\n\n        _this3.itemList = realItemList; // Llamamos a mergeItemList después de que todo haya terminado\n\n        _this3.mergeItemList();\n      })();\n    }\n\n    mergeItemList() {\n      var realTableBistList = [];\n      this.tableBisList.forEach(element => {\n        var itemID = parseInt(element.id);\n        var itemEncontrado = this.itemList.find(item => itemID === item.id);\n        const sourceFallback = this.getFallbackSourceByItemId(itemID);\n\n        if (itemEncontrado) {\n          var item = {};\n          const fullItem = this.itemList_full.find(itemFull => itemFull.id === itemID);\n          var iType = fullItem?.inventoryType;\n          const itemName = fullItem?.name ?? element.name;\n          const itemImg = fullItem?.icon ? `${this.wowIconBase}${fullItem.icon}.jpg` : element.img;\n          const instanceType = itemEncontrado.instance?.type;\n\n          if (instanceType == \"dungeon\") {\n            item = {\n              id: itemID,\n              spec: element.spec,\n              img: itemImg,\n              name: itemName,\n              instance: itemEncontrado.instance.name,\n              iType: iType,\n              sourceType: 'dungeon'\n            };\n            realTableBistList.push(item);\n          } else if (instanceType == \"raid\") {\n            item = {\n              id: itemID,\n              spec: element.spec,\n              img: itemImg,\n              name: itemName,\n              instance: itemEncontrado.instance.name,\n              boss: itemEncontrado.boss,\n              iType: iType,\n              sourceType: 'raid'\n            };\n            realTableBistList.push(item);\n          } else if (instanceType?.includes(\"profession\")) {\n            item = {\n              id: itemID,\n              spec: element.spec,\n              img: itemImg,\n              name: itemName,\n              instance: 'Crafted',\n              iType: iType,\n              sourceType: 'crafted'\n            };\n            realTableBistList.push(item);\n          } else if (instanceType == \"catalyst\") {\n            var bossTier = this.comprobarTier(fullItem?.inventoryType, element.spec[0]);\n\n            if (bossTier[0] == -1) {\n              item = {\n                id: itemID,\n                spec: element.spec,\n                img: itemImg,\n                name: itemName,\n                instance: 'Catalyst',\n                iType: iType,\n                sourceType: 'catalyst'\n              };\n              realTableBistList.push(item);\n            } else {\n              item = {\n                id: itemID,\n                spec: element.spec,\n                img: this.getTierImg(bossTier[1]),\n                name: bossTier[2],\n                instance: 'Tier',\n                iType: iType,\n                iTier: bossTier[1],\n                sourceType: 'tier'\n              };\n              realTableBistList.push(item);\n            }\n          } else {\n            item = {\n              id: itemID,\n              spec: element.spec,\n              img: itemImg,\n              name: itemName,\n              instance: sourceFallback || 'Crafted',\n              iType: iType,\n              sourceType: sourceFallback ? 'fallback' : 'crafted-fallback'\n            };\n            realTableBistList.push(item);\n          }\n        } else {\n          var item2 = {\n            id: itemID,\n            spec: element.spec,\n            img: element.img,\n            name: element.name,\n            instance: sourceFallback || 'Crafted',\n            sourceType: sourceFallback ? 'fallback' : 'crafted-fallback'\n          };\n          realTableBistList.push(item2);\n        }\n      });\n      realTableBistList = this.juntarTiers(realTableBistList);\n      realTableBistList = this.ordenarTabla(realTableBistList);\n      this.tableBisList = realTableBistList;\n      this.tableBisList_full = realTableBistList;\n      this.cargarDrops(this.tableBisList);\n      this.enrichUnknownItemMetadata();\n    }\n\n    cargarDrops(bisList) {\n      // Cargar filtro instances solo con opciones que tengan datos reales.\n      const availableInstances = [...new Set(bisList.map(item => item.instance).filter(instance => instance && instance !== 'Desconocido'))];\n      const mDungeons = this.instances.filter(ins => ins.type === \"dungeon\" && availableInstances.includes(ins.name)).map(ins => ins.name);\n      const fallbackDungeons = [...new Set(bisList.filter(item => item.sourceType === 'fallback' && item.instance && item.instance !== 'Desconocido' && !/questline/i.test(String(item.instance))).map(item => item.instance))];\n      const mDungeonPool = [...new Set([...mDungeons, ...fallbackDungeons])];\n      const fallbackLocations = [...new Set(bisList.filter(item => item.sourceType === 'fallback' && item.instance && item.instance !== 'Desconocido' && !mDungeonPool.includes(item.instance)).map(item => item.instance))];\n      this.instancesLibrary = ['M+ Dungeons'];\n\n      if (availableInstances.includes('Catalyst')) {\n        this.instancesLibrary.push('Catalyst');\n      }\n\n      if (availableInstances.includes('Crafted')) {\n        this.instancesLibrary.push('Crafted');\n      }\n\n      if (availableInstances.includes('Tier')) {\n        this.instancesLibrary.push('Tier');\n      }\n\n      const raidNamesWithData = this.instances.filter(ins => ins.type === \"raid\" && availableInstances.includes(ins.name)).map(ins => ins.name);\n      this.instancesLibrary.push(...raidNamesWithData);\n      this.instancesLibrary.push(...fallbackLocations); //Cargar filtro encounters\n\n      var bossLibrary = [...new Set(bisList.map(item => item.boss) // Extrae la propiedad 'boss'\n      .filter(boss => boss) // Filtra valores nulos o indefinidos\n      )];\n      this.encounterLibrary = [bossLibrary, mDungeonPool]; // Cargar filtro specs\n\n      this.specsLibrary = [...new Set(bisList.flatMap(item => item.spec) // Aplana todos los arrays de 'spec'\n      .filter(spec => spec) // Filtra valores nulos o indefinidos\n      )].sort((a, b) => a.localeCompare(b)); // Ordena alfabéticamente de forma ascendente\n      //Cargar filtro slot\n\n      this.slotsLibrary = ['head', 'neck', 'shoulder', 'back', 'chest', 'waist', 'legs', 'feet', 'wrist', 'hands', 'finger', 'trinket', 'main_hand', 'off_hand'];\n    }\n\n    ordenarTabla(tableBisList) {\n      tableBisList.sort((a, b) => {\n        // Primero comparamos la propiedad \"instance\"\n        if (a.instance < b.instance) {\n          return -1; // a debe ir antes que b\n        }\n\n        if (a.instance > b.instance) {\n          return 1; // b debe ir antes que a\n        } // Si las propiedades \"instance\" son iguales, comparamos \"boss\"\n\n\n        if (a.boss && b.boss) {\n          if (a.boss < b.boss) {\n            return -1; // a debe ir antes que b\n          }\n\n          if (a.boss > b.boss) {\n            return 1; // b debe ir antes que a\n          }\n        } // Si ambos son iguales, no cambiamos el orden\n\n\n        return 0;\n      });\n      return tableBisList; // Devuelve el array ordenado\n    }\n\n    getTierImg(tier) {\n      switch (tier) {\n        case 0:\n          return this.PH_image0;\n\n        case 1:\n          return this.PH_image1;\n\n        case 2:\n          return this.PH_image2;\n\n        case 3:\n          return this.PH_image3;\n\n        default:\n          return this.PH_image2;\n      }\n    }\n\n    juntarTiers(tableBisList) {\n      var slots = [\"Head\", \"Shoulder\", \"Chest\", \"Hands\", \"Legs\"];\n      var n = [0, 1, 2, 3]; // Recorremos todas las combinaciones posibles entre slots y n\n\n      slots.forEach(slot => {\n        n.forEach(num => {\n          tableBisList = this.filtrarTiers(tableBisList, num, slot);\n        });\n      });\n      return tableBisList;\n    }\n\n    filtrarTiers(tableBisList, num, slot) {\n      const filteredList = tableBisList.filter(item => item.instance === \"Tier\" && item.name === slot && item.iTier === num);\n\n      if (filteredList.length > 0) {\n        const mergedItem = { ...filteredList[0]\n        }; // Clona el primer objeto encontrado\n\n        mergedItem.spec = [...new Set(filteredList.flatMap(item => item.spec))]; // Combina y elimina duplicados\n        // Reemplaza los elementos filtrados con el objeto mergeado\n\n        tableBisList = tableBisList.filter(item => !(item.instance === \"Tier\" && item.name === slot && item.iTier === num)); // Añade el objeto mergeado a la lista\n\n        tableBisList.push(mergedItem);\n      }\n\n      return tableBisList;\n    }\n\n    getEncounter(id) {\n      return new Promise((resolve, reject) => {\n        this.blizzardService.getJournalEncounter(id).subscribe({\n          next: data => {\n            resolve(data.name); // Resolvemos la promesa con el nombre del encounter\n          },\n          error: err => {\n            console.error('Error fetching journal encounter data', err);\n            resolve(\"N/A\"); // Resolvemos con un valor por defecto si hay error\n          }\n        });\n      });\n    }\n\n    comprobarTier(slot, spec) {\n      const slotName = this.getTierSlotName(slot);\n\n      if (!slotName) {\n        return [-1, -1, ''];\n      }\n\n      return [1, this.getTier(spec), slotName];\n    }\n\n    getTierSlotName(slot) {\n      if (slot == 7) {\n        return 'Hands';\n      }\n\n      if (slot == 5 || slot == 20) {\n        return 'Chest';\n      }\n\n      if (slot == 10) {\n        return 'Legs';\n      }\n\n      if (slot == 3) {\n        return 'Shoulder';\n      }\n\n      if (slot == 1) {\n        return 'Head';\n      }\n\n      return '';\n    }\n\n    getTier(spec) {\n      if (spec == 'Devastation Evoker' || spec == 'Augmentation Evoker' || spec == 'Preservation Evoker') {\n        return 0;\n      }\n\n      if (spec == 'Balance Druid' || spec == 'Feral Druid' || spec == 'Guardian Druid' || spec == 'Restoration Druid') {\n        return 2;\n      }\n\n      if (spec == 'Unholy Death-Knight' || spec == 'Frost Death-Knight' || spec == 'Blood Death-Knight') {\n        return 1;\n      }\n\n      if (spec == 'Havoc Demon-Hunter' || spec == 'Vengeance Demon-Hunter') {\n        return 1;\n      }\n\n      if (spec == 'Mastery Hunter-Beast' || spec == 'Marksmanship Hunter' || spec == 'Survival Hunter') {\n        return 2;\n      }\n\n      if (spec == 'Enhancement Shaman' || spec == 'Elemental Shaman' || spec == 'Restoration Shaman') {\n        return 3;\n      }\n\n      if (spec == 'Assassination Rogue' || spec == 'Outlaw Rogue' || spec == 'Subtlety Rogue') {\n        return 0;\n      }\n\n      if (spec == 'Arcane Mage' || spec == 'Frost Mage' || spec == 'Fire Mage') {\n        return 2;\n      }\n\n      if (spec == 'Windwalker Monk' || spec == 'Brewmaster Monk' || spec == 'Mistweaver Monk') {\n        return 0;\n      }\n\n      if (spec == 'Fury Warrior' || spec == 'Arms Warrior' || spec == 'Protection Warrior') {\n        return 0;\n      }\n\n      if (spec == 'Affliction Warlock' || spec == 'Demonology Warlock' || spec == 'Destruction Warlock') {\n        return 1;\n      }\n\n      if (spec == 'Shadow Priest' || spec == 'Holy Priest' || spec == 'Discipline Priest') {\n        return 3;\n      }\n\n      if (spec == 'Retribution Paladin' || spec == 'Protection Paladin' || spec == 'Holy Paladin') {\n        return 3;\n      }\n\n      return -1;\n    }\n\n    resetFiltros() {\n      // Restablecer el valor de todos los filtros (usando los ids de los selects)\n      const selects = document.querySelectorAll('select');\n      selects.forEach(select => {\n        select.value = ''; // Restablecer el valor de cada select a vacío\n      });\n      this.selectedInstance = '';\n      this.selectedEncounter = '';\n      this.selectedSpec = '';\n      this.selectedSlot = '';\n      this.tableBisList = this.tableBisList_full;\n      this.encounterFlag = -1;\n    }\n\n    filtrar(filtro, data) {\n      const value = data.target.value;\n\n      switch (filtro) {\n        case 0:\n          this.selectedInstance = value;\n          this.selectedEncounter = '';\n          const bossSelect = document.getElementById('bosses');\n\n          if (bossSelect) {\n            bossSelect.value = '';\n          }\n\n          break;\n\n        case 1:\n          this.selectedEncounter = value;\n          break;\n\n        case 2:\n          this.selectedSpec = value;\n          break;\n\n        case 3:\n          this.selectedSlot = value;\n          break;\n\n        default:\n          this.resetFiltros();\n          return;\n      }\n\n      this.applyFilters();\n    }\n\n    applyFilters() {\n      let dataFiltrada = [...this.tableBisList_full];\n\n      if (this.selectedInstance) {\n        if (this.selectedInstance === 'M+ Dungeons') {\n          const mDungeons = this.encounterLibrary[1] || [];\n          dataFiltrada = dataFiltrada.filter(i => mDungeons.includes(i.instance));\n          this.encounterFlag = 1;\n        } else {\n          dataFiltrada = dataFiltrada.filter(i => i.instance === this.selectedInstance);\n          const hasRaidBosses = dataFiltrada.some(i => !!i.boss);\n          this.encounterFlag = hasRaidBosses ? 0 : -1;\n        }\n      } else {\n        this.encounterFlag = -1;\n      }\n\n      if (this.selectedEncounter) {\n        if (this.encounterFlag === 0) {\n          dataFiltrada = dataFiltrada.filter(i => i.boss === this.selectedEncounter);\n        } else if (this.encounterFlag === 1) {\n          dataFiltrada = dataFiltrada.filter(i => i.instance === this.selectedEncounter);\n        }\n      }\n\n      if (this.selectedSpec) {\n        dataFiltrada = dataFiltrada.filter(i => i.spec.includes(this.selectedSpec));\n        console.log(`[BiS Filter] Spec \"${this.selectedSpec}\": ${dataFiltrada.length} items`);\n      }\n\n      if (this.selectedSlot !== '') {\n        const slotIndex = parseInt(this.selectedSlot, 10);\n        const selectedSlotKey = this.slotsLibrary[slotIndex];\n        dataFiltrada = dataFiltrada.filter(i => this.resolveSlotKeyByInventoryType(Number(i.iType)) === selectedSlotKey);\n      }\n\n      this.tableBisList = dataFiltrada;\n    }\n\n    resolveSlotKeyByInventoryType(inventoryType) {\n      switch (inventoryType) {\n        case 1:\n          return 'head';\n\n        case 2:\n          return 'neck';\n\n        case 3:\n          return 'shoulder';\n\n        case 16:\n          return 'back';\n\n        case 5:\n        case 20:\n          return 'chest';\n\n        case 6:\n          return 'waist';\n\n        case 7:\n          return 'legs';\n\n        case 8:\n          return 'feet';\n\n        case 9:\n          return 'wrist';\n\n        case 10:\n          return 'hands';\n\n        case 11:\n          return 'finger';\n\n        case 12:\n          return 'trinket';\n\n        case 14: // shield\n\n        case 22: // weapon off-hand\n\n        case 23:\n          // holdable (off-hand)\n          return 'off_hand';\n\n        case 13: // one-hand weapon\n\n        case 15: // ranged\n\n        case 17: // two-hand weapon\n\n        case 21: // weapon main-hand\n\n        case 24: // ammo\n\n        case 25: // thrown\n\n        case 26: // ranged right\n\n        case 27: // quiver\n\n        case 28:\n          // relic\n          return 'main_hand';\n\n        default:\n          return '';\n      }\n    }\n\n    goMain() {\n      this.router.navigate(['/']);\n    }\n\n    reloadBisFromWowhead() {\n      var _this4 = this;\n\n      return _asyncToGenerator(function* () {\n        if (_this4.isReloadingBis) {\n          return;\n        }\n\n        _this4.isReloadingBis = true;\n        _this4.isLoading = true;\n        const isDev = !environment.production;\n        const sourceMap = {}; // Requisito: borrar siempre la bislist actual al recargar (no caché de items).\n\n        _this4.LocalDataService.clearGeneratedBisListTxt();\n\n        _this4.LocalDataService.clearGeneratedBisSources();\n\n        if (isDev) {\n          console.log('[BiS Reload] Start: limpiando bislist generada actual');\n        }\n\n        try {\n          const specMatrix = _this4.getWowheadSpecMatrix();\n\n          const blocks = [];\n          const specItemCounts = {};\n          let okCount = 0;\n          let failCount = 0;\n\n          if (isDev) {\n            console.log(`[BiS Reload] Total specs a procesar: ${specMatrix.length}`);\n          }\n\n          for (let index = 0; index < specMatrix.length; index++) {\n            const spec = specMatrix[index];\n            const url = `https://www.wowhead.com/guide/classes/${spec.classSlug}/${spec.specSlug}/bis-gear`;\n            const label = `${spec.classLabel} ${spec.specLabel}`;\n\n            try {\n              if (isDev) {\n                console.log(`[BiS Reload] [${index + 1}/${specMatrix.length}] Scraping ${label}`, url);\n              }\n\n              const scrapedPage = yield scrapeWowheadPage(url);\n              const bisItems = extractWowheadBisList(scrapedPage, 'Overall');\n\n              if (bisItems.length === 0) {\n                specItemCounts[label] = 0;\n                failCount++;\n\n                if (isDev) {\n                  console.warn(`[BiS Reload] ${label}: sin ítems en tab Overall`);\n                }\n\n                continue;\n              } // Guardamos IDs únicos por spec.\n\n\n              const uniqueIds = [...new Set(bisItems.map(x => x.itemId))];\n              specItemCounts[label] = uniqueIds.length;\n              const lines = [`${spec.classLabel} ${spec.specLabel}`, ...uniqueIds.map(id => id.toString()), ''];\n              blocks.push(lines.join('\\n'));\n              bisItems.forEach(item => {\n                const key = String(item.itemId);\n\n                if (!sourceMap[key]) {\n                  sourceMap[key] = [];\n                }\n\n                const source = _this4.selectSourceFallback(item.source);\n\n                if (source && !sourceMap[key].includes(source)) {\n                  sourceMap[key].push(source);\n                }\n              });\n              okCount++;\n\n              if (isDev) {\n                console.log(`[BiS Reload] ${label}: OK (${uniqueIds.length} itemIds únicos)`);\n              }\n            } catch (error) {\n              specItemCounts[label] = 0;\n              failCount++;\n              console.error(`[BiS Reload] ${label}: ERROR scraping ${url}`, error);\n            }\n          }\n\n          _this4.validateScrapedSpecCoverage(specMatrix, specItemCounts);\n\n          const generatedBisList = blocks.join('\\n');\n\n          if (!generatedBisList.trim()) {\n            throw new Error('No se pudo generar ninguna bislist desde Wowhead.');\n          }\n\n          _this4.LocalDataService.saveGeneratedBisListTxt(generatedBisList);\n\n          _this4.LocalDataService.saveGeneratedBisSources(sourceMap);\n\n          _this4.generatedBisSources = sourceMap;\n\n          if (isDev) {\n            console.log(`[BiS Reload] Guardado bisList generada. Specs OK: ${okCount}, fallidas/sin datos: ${failCount}`);\n          }\n\n          yield _this4.reloadBisViewData();\n\n          if (isDev) {\n            console.log('[BiS Reload] Recarga de vista completada');\n          }\n        } catch (error) {\n          console.error('Error recargando bislist desde Wowhead', error); // Si algo falla, restauramos estado de UI con datos actuales.\n\n          yield _this4.reloadBisViewData();\n        } finally {\n          _this4.isReloadingBis = false;\n          _this4.isLoading = false;\n\n          if (isDev) {\n            console.log('[BiS Reload] End');\n          }\n        }\n      })();\n    }\n\n    reloadBisViewData() {\n      var _this5 = this;\n\n      return _asyncToGenerator(function* () {\n        _this5.tableBisList = [];\n        _this5.tableBisList_full = [];\n        _this5.instances = [];\n        _this5.itemList = [];\n        _this5.itemList_full = [];\n        _this5.instancesLibrary = [];\n        _this5.encounterLibrary = [];\n        _this5.specsLibrary = [];\n        _this5.slotsLibrary = [];\n        _this5.generatedBisSources = _this5.LocalDataService.getGeneratedBisSources();\n\n        _this5.resetFiltros();\n\n        yield _this5.getBisListData();\n        yield _this5.getBosses();\n      })();\n    }\n\n    getWowheadSpecMatrix() {\n      return [{\n        classLabel: 'Death-Knight',\n        classSlug: 'death-knight',\n        specLabel: 'Blood',\n        specSlug: 'blood'\n      }, {\n        classLabel: 'Death-Knight',\n        classSlug: 'death-knight',\n        specLabel: 'Frost',\n        specSlug: 'frost'\n      }, {\n        classLabel: 'Death-Knight',\n        classSlug: 'death-knight',\n        specLabel: 'Unholy',\n        specSlug: 'unholy'\n      }, {\n        classLabel: 'Demon-Hunter',\n        classSlug: 'demon-hunter',\n        specLabel: 'Havoc',\n        specSlug: 'havoc'\n      }, {\n        classLabel: 'Demon-Hunter',\n        classSlug: 'demon-hunter',\n        specLabel: 'Vengeance',\n        specSlug: 'vengeance'\n      }, {\n        classLabel: 'Druid',\n        classSlug: 'druid',\n        specLabel: 'Balance',\n        specSlug: 'balance'\n      }, {\n        classLabel: 'Druid',\n        classSlug: 'druid',\n        specLabel: 'Feral',\n        specSlug: 'feral'\n      }, {\n        classLabel: 'Druid',\n        classSlug: 'druid',\n        specLabel: 'Guardian',\n        specSlug: 'guardian'\n      }, {\n        classLabel: 'Druid',\n        classSlug: 'druid',\n        specLabel: 'Restoration',\n        specSlug: 'restoration'\n      }, {\n        classLabel: 'Evoker',\n        classSlug: 'evoker',\n        specLabel: 'Devastation',\n        specSlug: 'devastation'\n      }, {\n        classLabel: 'Evoker',\n        classSlug: 'evoker',\n        specLabel: 'Preservation',\n        specSlug: 'preservation'\n      }, {\n        classLabel: 'Evoker',\n        classSlug: 'evoker',\n        specLabel: 'Augmentation',\n        specSlug: 'augmentation'\n      }, {\n        classLabel: 'Hunter',\n        classSlug: 'hunter',\n        specLabel: 'Beast-Mastery',\n        specSlug: 'beast-mastery'\n      }, {\n        classLabel: 'Hunter',\n        classSlug: 'hunter',\n        specLabel: 'Marksmanship',\n        specSlug: 'marksmanship'\n      }, {\n        classLabel: 'Hunter',\n        classSlug: 'hunter',\n        specLabel: 'Survival',\n        specSlug: 'survival'\n      }, {\n        classLabel: 'Mage',\n        classSlug: 'mage',\n        specLabel: 'Arcane',\n        specSlug: 'arcane'\n      }, {\n        classLabel: 'Mage',\n        classSlug: 'mage',\n        specLabel: 'Fire',\n        specSlug: 'fire'\n      }, {\n        classLabel: 'Mage',\n        classSlug: 'mage',\n        specLabel: 'Frost',\n        specSlug: 'frost'\n      }, {\n        classLabel: 'Monk',\n        classSlug: 'monk',\n        specLabel: 'Brewmaster',\n        specSlug: 'brewmaster'\n      }, {\n        classLabel: 'Monk',\n        classSlug: 'monk',\n        specLabel: 'Mistweaver',\n        specSlug: 'mistweaver'\n      }, {\n        classLabel: 'Monk',\n        classSlug: 'monk',\n        specLabel: 'Windwalker',\n        specSlug: 'windwalker'\n      }, {\n        classLabel: 'Paladin',\n        classSlug: 'paladin',\n        specLabel: 'Holy',\n        specSlug: 'holy'\n      }, {\n        classLabel: 'Paladin',\n        classSlug: 'paladin',\n        specLabel: 'Protection',\n        specSlug: 'protection'\n      }, {\n        classLabel: 'Paladin',\n        classSlug: 'paladin',\n        specLabel: 'Retribution',\n        specSlug: 'retribution'\n      }, {\n        classLabel: 'Priest',\n        classSlug: 'priest',\n        specLabel: 'Discipline',\n        specSlug: 'discipline'\n      }, {\n        classLabel: 'Priest',\n        classSlug: 'priest',\n        specLabel: 'Holy',\n        specSlug: 'holy'\n      }, {\n        classLabel: 'Priest',\n        classSlug: 'priest',\n        specLabel: 'Shadow',\n        specSlug: 'shadow'\n      }, {\n        classLabel: 'Rogue',\n        classSlug: 'rogue',\n        specLabel: 'Assassination',\n        specSlug: 'assassination'\n      }, {\n        classLabel: 'Rogue',\n        classSlug: 'rogue',\n        specLabel: 'Outlaw',\n        specSlug: 'outlaw'\n      }, {\n        classLabel: 'Rogue',\n        classSlug: 'rogue',\n        specLabel: 'Subtlety',\n        specSlug: 'subtlety'\n      }, {\n        classLabel: 'Shaman',\n        classSlug: 'shaman',\n        specLabel: 'Elemental',\n        specSlug: 'elemental'\n      }, {\n        classLabel: 'Shaman',\n        classSlug: 'shaman',\n        specLabel: 'Enhancement',\n        specSlug: 'enhancement'\n      }, {\n        classLabel: 'Shaman',\n        classSlug: 'shaman',\n        specLabel: 'Restoration',\n        specSlug: 'restoration'\n      }, {\n        classLabel: 'Warlock',\n        classSlug: 'warlock',\n        specLabel: 'Affliction',\n        specSlug: 'affliction'\n      }, {\n        classLabel: 'Warlock',\n        classSlug: 'warlock',\n        specLabel: 'Demonology',\n        specSlug: 'demonology'\n      }, {\n        classLabel: 'Warlock',\n        classSlug: 'warlock',\n        specLabel: 'Destruction',\n        specSlug: 'destruction'\n      }, {\n        classLabel: 'Warrior',\n        classSlug: 'warrior',\n        specLabel: 'Arms',\n        specSlug: 'arms'\n      }, {\n        classLabel: 'Warrior',\n        classSlug: 'warrior',\n        specLabel: 'Fury',\n        specSlug: 'fury'\n      }, {\n        classLabel: 'Warrior',\n        classSlug: 'warrior',\n        specLabel: 'Protection',\n        specSlug: 'protection'\n      }];\n    }\n\n    getCurrentBisItemIds() {\n      const ids = new Set();\n      this.allBisList.forEach(specBlock => {\n        specBlock.slice(1).forEach(itemId => {\n          const n = Number(itemId);\n\n          if (!Number.isNaN(n)) {\n            ids.add(n);\n          }\n        });\n      });\n      return [...ids];\n    }\n\n    enrichUnknownItemMetadata() {\n      var _this6 = this;\n\n      return _asyncToGenerator(function* () {\n        const unknownItems = _this6.tableBisList_full.filter(item => !item.img || String(item.name).startsWith('Item '));\n\n        for (const item of unknownItems) {\n          const itemId = Number(item.id);\n\n          if (!Number.isInteger(itemId) || itemId <= 0) {\n            continue;\n          }\n\n          try {\n            const [nameData, mediaData] = yield Promise.all([firstValueFrom(_this6.blizzardService.getItemName(itemId)), firstValueFrom(_this6.blizzardService.getItemMedia(itemId))]);\n            const name = nameData?.name;\n            const iconUrl = mediaData?.assets?.find(asset => asset.key === 'icon')?.value;\n\n            _this6.tableBisList_full.forEach(x => {\n              if (Number(x.id) === itemId) {\n                if (name) {\n                  x.name = name;\n                }\n\n                if (iconUrl) {\n                  x.img = iconUrl;\n                }\n              }\n            });\n          } catch {// Silencioso en UI: si no hay cache/backend disponible, mantenemos placeholder.\n          }\n        }\n\n        _this6.applyFilters();\n      })();\n    }\n\n    cacheMissingItems() {\n      var _this7 = this;\n\n      return _asyncToGenerator(function* () {\n        const ids = _this7.getCurrentBisItemIds();\n\n        if (ids.length === 0) {\n          console.warn('[BiS Cache] No hay itemIds para cachear');\n          return;\n        }\n\n        _this7.isLoading = true;\n\n        try {\n          const response = yield fetch(`${_this7.cacheApiBase}/cache/items/prefetch`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              itemIds: ids\n            })\n          });\n\n          if (!response.ok) {\n            throw new Error(`Prefetch failed (${response.status})`);\n          }\n\n          const result = yield response.json();\n          console.log('[BiS Cache] Prefetch completado:', result);\n        } catch (error) {\n          console.error('[BiS Cache] Error cacheando items. ¿Está levantado server/server.js?', error);\n        } finally {\n          _this7.isLoading = false;\n        }\n      })();\n    }\n\n    clearItemCache() {\n      var _this8 = this;\n\n      return _asyncToGenerator(function* () {\n        _this8.isLoading = true;\n\n        try {\n          const response = yield fetch(`${_this8.cacheApiBase}/cache/items`, {\n            method: 'DELETE'\n          });\n\n          if (!response.ok) {\n            throw new Error(`Clear cache failed (${response.status})`);\n          }\n\n          const result = yield response.json();\n          console.log('[BiS Cache] Cache limpiada:', result);\n        } catch (error) {\n          console.error('[BiS Cache] Error limpiando cache. ¿Está levantado server/server.js?', error);\n        } finally {\n          _this8.isLoading = false;\n        }\n      })();\n    }\n\n    getFallbackSourceByItemId(itemId) {\n      const sources = this.generatedBisSources[String(itemId)] ?? [];\n      const fallback = sources.find(s => !!s && s !== 'Unknown' && s !== 'Desconocido');\n      return fallback ?? '';\n    }\n\n    selectSourceFallback(rawSource) {\n      const cleaned = String(rawSource ?? '').replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').replace(/\\|/g, ' ').trim();\n\n      if (!cleaned) {\n        return '';\n      }\n\n      if (/(blacksmithing|leatherworking|tailoring|jewelcrafting|inscription|alchemy|engineering|enchanting)/i.test(cleaned)) {\n        return 'Crafted';\n      }\n\n      if (/questline/i.test(cleaned)) {\n        return 'Questline';\n      }\n\n      const parts = cleaned.split(' ');\n\n      if (parts.length === 1 && /^[A-Z][a-z]+$/.test(parts[0])) {\n        // Evita guardar labels demasiado genéricos tipo \"Raid\" o \"Vault\".\n        return '';\n      }\n\n      return cleaned;\n    }\n\n    validateScrapedSpecCoverage(specMatrix, specItemCounts) {\n      const expectedLabels = specMatrix.map(spec => `${spec.classLabel} ${spec.specLabel}`);\n      const missingSpecs = expectedLabels.filter(label => !(label in specItemCounts));\n      const specsUnderMin = expectedLabels.filter(label => (specItemCounts[label] ?? 0) < 15).map(label => `${label} (${specItemCounts[label] ?? 0})`);\n      console.log(`[BiS Reload][Validation] Specs esperadas: ${expectedLabels.length}, scrapeadas: ${Object.keys(specItemCounts).length}`);\n\n      if (missingSpecs.length > 0) {\n        console.error('[BiS Reload][Validation] Faltan specs:', missingSpecs);\n      }\n\n      if (specsUnderMin.length > 0) {\n        console.error('[BiS Reload][Validation] Specs con menos de 15 items:', specsUnderMin);\n      } else {\n        console.log('[BiS Reload][Validation] OK: todas las specs tienen al menos 15 items.');\n      }\n    }\n\n  }\n\n  BisesComponent.ɵfac = function BisesComponent_Factory(t) {\n    return new (t || BisesComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.LocalDataService), i0.ɵɵdirectiveInject(i3.RaidbotsApiService), i0.ɵɵdirectiveInject(i4.BlizzardApiService), i0.ɵɵdirectiveInject(i5.Router));\n  };\n\n  BisesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BisesComponent,\n    selectors: [[\"app-bises\"]],\n    decls: 31,\n    vars: 10,\n    consts: [[1, \"bises-page\"], [1, \"top-panel\"], [1, \"panel-title\"], [1, \"filters-grid\"], [\"name\", \"Instances\", \"id\", \"instances\", 3, \"change\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"Bosses\", \"id\", \"bosses\", 3, \"change\", 4, \"ngIf\"], [\"name\", \"Specs\", \"id\", \"specs\", 3, \"change\"], [\"name\", \"Slots\", \"id\", \"slots\", 3, \"change\"], [1, \"actions-row\"], [4, \"ngIf\", \"ngIfElse\"], [\"adminConfigEntry\", \"\"], [\"class\", \"btn ghost\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"primary\", 3, \"click\"], [\"class\", \"items-grid\", 4, \"ngIf\"], [\"class\", \"loading-message\", 4, \"ngIf\"], [\"class\", \"modal-backdrop\", 3, \"click\", 4, \"ngIf\"], [3, \"value\"], [\"name\", \"Bosses\", \"id\", \"bosses\", 3, \"change\"], [\"value\", \"\", 4, \"ngIf\"], [\"title\", \"Recargar BiS desde Wowhead\", 1, \"btn\", \"ghost\", 3, \"click\"], [\"title\", \"Cachear items faltantes en Blizzard API\", 1, \"btn\", \"ghost\", 3, \"click\"], [\"title\", \"Limpiar cache de items\", 1, \"btn\", \"ghost\", \"danger\", 3, \"click\"], [\"title\", \"Configuraci\\u00F3n admin\", 1, \"btn\", \"ghost\", 3, \"click\"], [1, \"btn\", \"ghost\", 3, \"click\"], [1, \"items-grid\"], [\"class\", \"bis-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"bis-card\"], [\"alt\", \"Item Image\", 3, \"src\", 4, \"ngIf\"], [1, \"item-content\"], [1, \"spec-tags\"], [3, \"ngStyle\", 4, \"ngFor\", \"ngForOf\"], [\"alt\", \"Item Image\", 3, \"src\"], [3, \"ngStyle\"], [1, \"loading-message\"], [1, \"modal-backdrop\", 3, \"click\"], [1, \"modal-card\", 3, \"click\"], [\"type\", \"password\", \"placeholder\", \"Password\", 3, \"ngModel\", \"ngModelChange\", \"keydown.enter\"], [\"class\", \"modal-error\", 4, \"ngIf\"], [1, \"modal-actions\"], [1, \"modal-error\"]],\n    template: function BisesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"main\", 0)(1, \"section\", 1)(2, \"div\", 2)(3, \"h1\");\n        i0.ɵɵtext(4, \"BiS Atlas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"p\");\n        i0.ɵɵtext(6, \"Explore best-in-slot sources by instance, boss, specialization and slot.\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"div\", 3)(8, \"select\", 4);\n        i0.ɵɵlistener(\"change\", function BisesComponent_Template_select_change_8_listener($event) {\n          return ctx.filtrar(0, $event);\n        });\n        i0.ɵɵelementStart(9, \"option\", 5);\n        i0.ɵɵtext(10, \"Location\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(11, BisesComponent_option_11_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, BisesComponent_select_12_Template, 4, 3, \"select\", 7);\n        i0.ɵɵelementStart(13, \"select\", 8);\n        i0.ɵɵlistener(\"change\", function BisesComponent_Template_select_change_13_listener($event) {\n          return ctx.filtrar(2, $event);\n        });\n        i0.ɵɵelementStart(14, \"option\", 5);\n        i0.ɵɵtext(15, \"Specs\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(16, BisesComponent_option_16_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"select\", 9);\n        i0.ɵɵlistener(\"change\", function BisesComponent_Template_select_change_17_listener($event) {\n          return ctx.filtrar(3, $event);\n        });\n        i0.ɵɵelementStart(18, \"option\", 5);\n        i0.ɵɵtext(19, \"Slots\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(20, BisesComponent_option_20_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(21, \"div\", 10);\n        i0.ɵɵtemplate(22, BisesComponent_ng_container_22_Template, 7, 0, \"ng-container\", 11);\n        i0.ɵɵtemplate(23, BisesComponent_ng_template_23_Template, 2, 0, \"ng-template\", null, 12, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(25, BisesComponent_button_25_Template, 2, 0, \"button\", 13);\n        i0.ɵɵelementStart(26, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function BisesComponent_Template_button_click_26_listener() {\n          return ctx.goMain();\n        });\n        i0.ɵɵtext(27, \"Main\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(28, BisesComponent_section_28_Template, 2, 1, \"section\", 15);\n        i0.ɵɵtemplate(29, BisesComponent_div_29_Template, 3, 0, \"div\", 16);\n        i0.ɵɵtemplate(30, BisesComponent_div_30_Template, 13, 2, \"div\", 17);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r5 = i0.ɵɵreference(24);\n\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.instancesLibrary);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.encounterFlag != -1);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.specsLibrary);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.slotsLibrary);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isAdminConfigEnabled)(\"ngIfElse\", _r5);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.tableBisList != ctx.tableBisList_full);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showAdminModal);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i6.NgStyle, i7.NgSelectOption, i7.ɵNgSelectMultipleOption, i7.DefaultValueAccessor, i7.NgControlStatus, i7.NgModel],\n    styles: [\".bises-page[_ngcontent-%COMP%]{width:min(1400px,95vw);margin:2rem auto 3rem;display:grid;gap:1.25rem}.top-panel[_ngcontent-%COMP%]{background:linear-gradient(135deg,#182831 0%,#1e2d3d 62%,#31261d 100%);border:1px solid #304250;border-radius:18px;box-shadow:0 20px 40px #02040b80;padding:1.25rem;display:grid;gap:1rem}.panel-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:clamp(1.5rem,2vw,2.2rem);color:#f0f7ff}.panel-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.35rem 0 0;color:#b5c4de;font-size:.98rem}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,minmax(170px,1fr));gap:.75rem}select[_ngcontent-%COMP%]{width:100%;border:1px solid #3b4d5f;border-radius:12px;background:#111a28;color:#e2edff;padding:.7rem .8rem;font-size:.95rem;font-weight:600}select[_ngcontent-%COMP%]:focus{outline:2px solid #7ec1ff;outline-offset:2px}.actions-row[_ngcontent-%COMP%]{display:flex;gap:.6rem;justify-content:flex-end}.btn[_ngcontent-%COMP%]{border:0;border-radius:12px;padding:.62rem .9rem;font-size:.92rem;font-weight:700;cursor:pointer;transition:transform .15s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.btn.primary[_ngcontent-%COMP%]{background:#2e9f84;color:#fff}.btn.ghost[_ngcontent-%COMP%]{background:#122130;color:#e2eeff;border:1px solid #39506a}.btn.danger[_ngcontent-%COMP%]{color:#ffd7df;border-color:#7a3b50;background:#311826}.items-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:.95rem}.bis-card[_ngcontent-%COMP%]{background:#161f2f;border:1px solid #2f4055;border-radius:16px;box-shadow:0 10px 25px #02040c73;padding:.95rem;display:grid;grid-template-columns:58px 1fr;gap:.85rem;align-items:start}.bis-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:58px;height:58px;border-radius:10px;border:1px solid #3b4d61;background:#0f1726}.item-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#f1f7ff;font-size:1rem}.item-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.28rem 0 .5rem;color:#b3c2de;font-size:.87rem}.spec-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.4rem .65rem}.spec-tags[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.83rem;font-weight:700}.loading-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;min-height:50vh}.loading-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:800;color:#e3eeff;padding:1rem 1.2rem;background:#1a2638;border-radius:12px;border:1px solid #354b67}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(5,10,18,.68);display:flex;align-items:center;justify-content:center;z-index:50}.modal-card[_ngcontent-%COMP%]{width:min(430px,92vw);background:#162231;border:1px solid #35506a;border-radius:14px;box-shadow:0 20px 45px #00000080;padding:1rem;display:grid;gap:.7rem}.modal-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#f1f7ff;font-size:1.1rem}.modal-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#b6c7de;font-size:.92rem}.modal-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border:1px solid #3b4d5f;border-radius:10px;background:#0f1724;color:#e2edff;padding:.62rem .72rem;font-size:.93rem;font-weight:600}.modal-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:2px solid #7ec1ff;outline-offset:2px}.modal-error[_ngcontent-%COMP%]{color:#ff9fb2!important;font-weight:700}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem}@media (max-width: 900px){.filters-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(150px,1fr))}.items-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 560px){.bises-page[_ngcontent-%COMP%]{width:94vw}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.actions-row[_ngcontent-%COMP%]{justify-content:stretch}.btn[_ngcontent-%COMP%]{flex:1}}\"]\n  });\n  return BisesComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}